apiVersion: core.giantswarm.io/v1alpha1
kind: DeletionBlock
metadata:
  # testing for unique finalizers per CR
  name: blocker-for-kubeadm-config-template-2
spec:
  rule:
    type: IfNotExists
    query: '{{ eq .dependent.spec.template.spec.bootstrap.configRef.name .managed.metadata.name }}'
    managed:
      group: bootstrap.cluster.x-k8s.io
      version: v1beta1
      kind: KubeadmConfigTemplate
    dependent:
      group: cluster.x-k8s.io
      version: v1beta1
      kind: MachineSet